<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0054)http://www.oooforum.org/forum/viewtopic.phtml?p=226754 -->
<HTML dir="ltr"><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8">

<META http-equiv="Content-Style-Type" content="text/css">
<LINK rel="SHORTCUT ICON" href="http://www.oooforum.org/favicon.ico">

<LINK rel="top" href="http://www.oooforum.org/forum/index.phtml" title="OOoForum.org Forum Index">
<LINK rel="search" href="http://www.oooforum.org/forum/search.phtml" title="Search">
<LINK rel="help" href="http://www.oooforum.org/forum/faq.phtml" title="FAQ">
<LINK rel="author" href="http://www.oooforum.org/forum/memberlist.phtml" title="Memberlist">
<LINK rel="prev" href="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&view=previous" title="View previous topic">
<LINK rel="next" href="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&view=next" title="View next topic">
<LINK rel="up" href="http://www.oooforum.org/forum/viewforum.phtml?f=11" title="OpenOffice.org Code Snippets">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=1" title="Setup and Troubleshooting">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=2" title="OpenOffice.org Writer">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=3" title="OpenOffice.org Calc">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=4" title="OpenOffice.org Impress">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=5" title="OpenOffice.org Draw">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=6" title="OpenOffice.org Math">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=10" title="OpenOffice.org Base">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=9" title="OpenOffice.org Macros and API">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=11" title="OpenOffice.org Code Snippets">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=7" title="General Discussion">
<LINK rel="chapter forum" href="http://www.oooforum.org/forum/viewforum.phtml?f=8" title="Site Feedback">

<TITLE>OpenOffice.org Forum :: code: draw: export current selection to eps</TITLE>
<META name="description" content="The OpenOffice.org Forum at OOoForum.org is an OpenOffice.org help and discussion forum for exchanging information and tips with other users of OpenOffice.org, the open source office suite.">
<META name="keywords" content="OpenOffice Forum, OpenOffice Help, OpenOffice Support, Setup, Troubleshooting, Documentation, Open Source, Office, Office Suite, Bulletin Board, Discussion Forum, Forum, Help, OpenOffice, OpenOffice.org, FAQ, Howto, productivity software, StarOffice, Writer, Calc, Impress, Draw, Math">
<!-- The OpenOffice.org Forum at OOoForum.org is an OpenOffice.org help and discussion forum for exchanging information and tips with other users of OpenOffice.org, the open source office suite.-->
<LINK rel="stylesheet" href="./OpenOffice.org Forum    code  draw  export current selection to eps_files/subSilver.css" type="text/css">
</HEAD><BODY leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" bgcolor="#808F9E" text="#000000" link="#002B84" vlink="#35424D">

<A name="top"></A>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
  <TBODY><TR bgcolor="#000000">
    <TD colspan="2"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/10x17_black.gif" width="10" height="17"></TD>
  </TR>
  <TR bgcolor="#FFFFFF">
    <TD><A href="http://www.oooforum.org/"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/sitename.gif" width="185" height="45" alt="OpenOffice.org Forum at OOoForum.org" border="0"></A><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/tagline.gif" width="185" height="45" alt="The OpenOffice.org Forum"></TD>
    <TD>
      <DIV align="right"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/gulls_right.gif" width="180" height="45"></DIV>
    </TD>
  </TR>
  <TR>
    <TD colspan="2" background="./OpenOffice.org Forum    code  draw  export current selection to eps_files/horizon-tiny.gif">&nbsp;</TD>
  </TR>
</TBODY></TABLE>
<TABLE width="100%" cellspacing="0" cellpadding="10" border="0" align="center">
	<TBODY><TR>
		<TD class="bodyline"><TABLE width="100%" cellspacing="0" cellpadding="0" border="0">
			<TBODY><TR>
				<TD align="center" width="100%" valign="middle">
				<TABLE cellspacing="0" cellpadding="2" border="0">
					<TBODY><TR>
						<TD align="center" valign="top" nowrap="nowrap"><SPAN class="mainmenu">&nbsp;[<A href="http://www.oooforum.org/" class="mainmenu">Home</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/faq.phtml" class="mainmenu">FAQ</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/search.phtml" class="mainmenu">Search</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/memberlist.phtml" class="mainmenu">Memberlist</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/groupcp.phtml" class="mainmenu">Usergroups</A>]&nbsp;
						&nbsp;[<A href="http://www.oooforum.org/forum/profile.phtml?mode=register" class="mainmenu">Register</A>]&nbsp;
						</SPAN></TD>
					</TR>
					<TR>
						<TD height="25" align="center" valign="top" nowrap="nowrap"><SPAN class="mainmenu">&nbsp;[<A href="http://www.oooforum.org/forum/profile.phtml?mode=editprofile" class="mainmenu">Profile</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/privmsg.phtml?folder=inbox" class="mainmenu">Log in to check your private messages</A>]&nbsp; &nbsp;[<A href="http://www.oooforum.org/forum/login.phtml" class="mainmenu">Log in</A>]&nbsp;</SPAN></TD>
					</TR>
				</TBODY></TABLE></TD>
			</TR>
		</TBODY></TABLE>
		<BR>


<TABLE width="100%" cellspacing="2" cellpadding="2" border="0">
  <TBODY><TR>
	<TD align="left" valign="bottom" colspan="2"><A class="maintitle" href="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&start=0&postdays=0&postorder=asc&highlight=">code: draw: export current selection to eps</A><BR>
	  <SPAN class="gensmall"><B></B><BR>
	  &nbsp; </SPAN></TD>
  </TR>
</TBODY></TABLE>

<TABLE width="100%" cellspacing="2" cellpadding="2" border="0">
  <TBODY><TR>
	<TD align="left" valign="bottom" nowrap="nowrap"><SPAN class="nav"><A href="http://www.oooforum.org/forum/posting.phtml?mode=newtopic&f=11"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/post.gif" border="0" alt="Post new topic" align="middle"></A>&nbsp;&nbsp;&nbsp;<A href="http://www.oooforum.org/forum/posting.phtml?mode=reply&t=6769"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/reply.gif" border="0" alt="Reply to topic" align="middle"></A></SPAN></TD>
	<TD align="left" valign="middle" width="100%"><SPAN class="nav">&nbsp;&nbsp;&nbsp;<A href="http://www.oooforum.org/forum/index.phtml" class="nav">OOoForum.org Forum Index</A>
	  -&gt; <A href="http://www.oooforum.org/forum/viewforum.phtml?f=11" class="nav">OpenOffice.org Code Snippets</A></SPAN></TD>
  </TR>
</TBODY></TABLE>

<TABLE class="forumline" width="100%" cellspacing="1" cellpadding="3" border="0">
	<TBODY><TR align="right">
		<TD class="catHead" colspan="2" height="28"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&view=previous" class="nav">View previous topic</A> :: <A href="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&view=next" class="nav">View next topic</A> &nbsp;</SPAN></TD>
	</TR>
	
	<TR>
		<TH class="thLeft" width="150" height="26" nowrap="nowrap">Author</TH>
		<TH class="thRight" nowrap="nowrap">Message</TH>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row1"><SPAN class="name"><A name="25018"></A><B>emil kasulzke</B></SPAN><BR><SPAN class="postdetails">Guest<BR><BR><BR><BR><BR></SPAN><BR></TD>
		<TD class="row1" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=25018#25018"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Fri Mar 12, 2004 11:31 am<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: code: draw: export current selection to eps</SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=25018"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">Hi all,
<BR>

<BR>
I've been trying for a while to write a macro that exports the current selection of a draw page to eps. I've read through a bunch of postings in this forum and through the ooo dev guide, but didn't get the thing really running (had difficulties assigning the selection to the filter and setting the filter properties correctly), until I stumbled over an ooo bug report (7918) about eps that contains a small sample script which solved most of my export problems.
<BR>
 I thought some of you might be interested in the macro.
<BR>
It does the following: 
<BR>
Get the selection of the current draw page and export it to eps. The name of the eps is constructed from the name of the original sxd and the name of the current draw page.
<BR>
If there is no current selection, all shapes in the current page are selected. 
<BR>
It is easy to change the macro to export the whole page or to export to another format.
<BR>

<BR>
Any comments or tips for improvement are welcome <IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_smile.gif" alt="Smile" border="0">
<BR>

<BR>
Cheers,
<BR>
emil
<BR>

<BR>
Here is the code:
<BR>
 </SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">
<BR>
' gets all shapes in the current draw page
<BR>
' @param page: A XDrawPage. If page is not a XDrawPage, an empty shapes collection is returned.
<BR>
' @return: a com.sun.star.drawing.ShapeCollection containing all shapes, may be empty.
<BR>
function getAllShapesInDrawPage(thePage as Object)
<BR>
&nbsp; &nbsp;' create empty collection of shapes
<BR>
&nbsp; &nbsp;theShapes= createUnoService("com.sun.star.drawing.ShapeCollection")
<BR>
&nbsp; &nbsp;if not hasUnoInterfaces(thePage, "com.sun.star.drawing.XDrawPage") then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;getAllShapesInDrawPage = theShapes
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;exit function
<BR>
&nbsp; &nbsp;end if
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;' add all shapes in the page to the collection&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;for i=0 to thePage.getCount() - 1
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;theShapes.add(thePage.getByIndex(i))
<BR>
&nbsp; &nbsp;next i
<BR>
&nbsp; &nbsp;getAllShapesInDrawPage = theShapes
<BR>
end function
<BR>

<BR>

<BR>
' From a Draw page, export the current selection to eps. If the current selection is empty, select all 
<BR>
' shapes on the page and export them. If there are no shapes on the page, export the empty page.
<BR>
' Parts of this code are taken from the code in ooo bug 7918.
<BR>
sub exportSelectionOrPageToEps
<BR>
&nbsp; &nbsp;Dim currentPageName as String
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;theDoc = StarDesktop.getCurrentComponent()
<BR>
&nbsp; &nbsp;if not theDoc.SupportsService( "com.sun.star.drawing.DrawingDocument" ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Msgbox("The current document must be a Draw document", 0)
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;exit sub
<BR>
&nbsp; &nbsp;end if 
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;
<BR>
&nbsp;&nbsp; &nbsp;theController = theDoc.currentController &nbsp; &nbsp;
<BR>
&nbsp; &nbsp;thePage = theController.currentPage
<BR>
&nbsp;&nbsp; &nbsp;theSelection = theController.selection
<BR>

<BR>
&nbsp; &nbsp;' if nothing is selected, select all shapes in the current page
<BR>
&nbsp; &nbsp;if isEmpty(theSelection) then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;MsgBox("selection is empty, will select everything in current page", 0)
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;theController.select(getAllShapesInDrawPage(thePage))
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;theSelection = theDoc.currentController.selection
<BR>
&nbsp; &nbsp;end if
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;'create url for storing
<BR>
&nbsp; &nbsp;Dim origUrl as String
<BR>
&nbsp; &nbsp;Dim exportUrl as new com.sun.star.util.URL
<BR>
&nbsp; &nbsp;origUrl = theDoc.url
<BR>
&nbsp; &nbsp;if isnull(thePage.name) then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;exportUrl.complete = Left( origUrl, Len(origUrl) - 4 ) + "_Export" + ".eps"
<BR>
&nbsp;&nbsp; &nbsp;else
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;exportUrl.complete = Left( origUrl, Len(origUrl) - 4 ) + "_" + thePage.name + ".eps" &nbsp; &nbsp;
<BR>
&nbsp;&nbsp; &nbsp;endif
<BR>
&nbsp;&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;' Create the export filter.
<BR>
&nbsp;&nbsp; &nbsp;' A GraphicExportFilter uses a page, shape or collection of shapes as source.
<BR>
&nbsp;&nbsp; &nbsp;theExporter = createUnoService( "com.sun.star.drawing.GraphicExportFilter" )
<BR>
&nbsp;&nbsp; &nbsp;
<BR>
&nbsp;&nbsp; &nbsp;' Export selection if something is selected, otherwise whole page.
<BR>
&nbsp;&nbsp; &nbsp;if not isEmpty(theSelection) then
<BR>
&nbsp; &nbsp; &nbsp; &nbsp;theExporter.SetSourceDocument(theSelection)
<BR>
&nbsp;&nbsp; &nbsp;else
<BR>
&nbsp; &nbsp; &nbsp; &nbsp;msgbox("no selection, exporting whole page", 0)
<BR>
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;theExporter.SetSourceDocument(thePage)
<BR>
&nbsp;&nbsp; &nbsp;endif
<BR>
&nbsp;
<BR>
&nbsp;&nbsp; &nbsp;' Set the filter data
<BR>
&nbsp;&nbsp; &nbsp;Dim aFilterData(5) as new com.sun.star.beans.PropertyValue
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(0).Name = "Level" '1=PS level 1, 2=PS level 2
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(0).Value = 2
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(1).Name = "ColorFormat" '1=color, 2=grayscale
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(1).Value = 1
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(2).Name = "TextMode" '0=glyph outlines, 1=no glyph outlines, see ooo bug 7918
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(2).Value = 1
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(3).Name = "Preview" '0=none,1=TIFF,2=EPSI,3=TIFF+EPSI
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(3).Value = 0
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(4).Name = "CompressionMode" ' 1=LZW, 2=none
<BR>
&nbsp;&nbsp; &nbsp;aFilterData(4).Value = 2
<BR>
&nbsp;&nbsp; &nbsp;Dim aArgs (2) as new com.sun.star.beans.PropertyValue
<BR>
&nbsp;&nbsp; &nbsp;aArgs(0).Name = "MediaType"
<BR>
&nbsp;&nbsp; &nbsp;aArgs(0).Value = "application/postscript"
<BR>
&nbsp;&nbsp; &nbsp;aArgs(1).Name = "URL"
<BR>
&nbsp;&nbsp; &nbsp;aArgs(1).Value = exportUrl
<BR>
&nbsp;&nbsp; &nbsp;aArgs(2).Name = "FilterData"
<BR>
&nbsp;&nbsp; &nbsp;aArgs(2).Value = aFilterData()
<BR>
&nbsp;&nbsp; &nbsp;theExporter.filter(aArgs())
<BR>
&nbsp;
<BR>
&nbsp;&nbsp; &nbsp;MsgBox("exported " + origUrl + " to " + exportUrl.complete, 0)
<BR>
End Sub
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody"></SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row1" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap">      <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row2"><SPAN class="name"><A name="25035"></A><B>DannyB</B></SPAN><BR><SPAN class="postdetails">Moderator<BR><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/rank5.gif" alt="Moderator" title="Moderator" border="0"><BR><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/41446a133fa81cc7182e6.gif" alt="" border="0"><BR><BR>Joined: 02 Apr 2003<BR>Posts: 3994<BR>Location: Lawrence, Kansas, USA</SPAN><BR></TD>
		<TD class="row2" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=25035#25035"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Fri Mar 12, 2004 5:48 pm<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: </SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=25035"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">That is a very interesting example.  A technique I was unaware of.
<BR>

<BR>
emil, would you mind if this very interesting thread were moved to the Code Snippets forum?  Please reply if that is okay (or not okay) with you.
<BR>

<BR>
To see the MIME types supported, use this....
<BR>

<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">Sub ShowExportMimeTypes()
<BR>
&nbsp; &nbsp;oDoc = ThisComponent
<BR>
&nbsp; &nbsp;oExportFilter = createUnoService( "com.sun.star.drawing.GraphicExportFilter" )
<BR>
&nbsp; &nbsp;aMimeTypeNames = oExportFilter.getSupportedMimeTypeNames()
<BR>

<BR>
&nbsp; &nbsp;' Display result in a MsgBox...
<BR>
&nbsp; &nbsp;MsgBox Join( aMimeTypeNames, Chr(13) )
<BR>

<BR>
&nbsp; &nbsp;' Display result in a Writer doc.
<BR>
&nbsp; &nbsp;oOutput = StarDesktop.loadComponentFromURL( "private:factory/swriter", "_blank", 0, Array() )
<BR>
&nbsp; &nbsp;Writer_PrintLn( oOutput, Join( aMimeTypeNames, Chr(13) ) )
<BR>
End Sub
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>

<BR>
To only see the output in a MsgBox, you must comment the last couple statements.
<BR>

<BR>
If you leave the last couple statements uncommented, then output appears in a new Writer document.  In that case, you also need the following additional code ripped from my library....
<BR>

<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">' Sugar Coated way to Print into a Writer document.
<BR>
' The oOutput parameter can be any of....
<BR>
'&nbsp; &nbsp;com.sun.star.text.TextDocument
<BR>
'&nbsp; &nbsp;com.sun.star.text.Text
<BR>
'&nbsp; &nbsp;com.sun.star.drawing.Text
<BR>
'&nbsp; &nbsp;com.sun.star.text.TextCursor
<BR>
Sub Writer_Print( oOutput, cString )
<BR>
&nbsp; &nbsp;If oOutput.SupportsService( "com.sun.star.text.TextDocument" ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oText = oOutput.getText()
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oCursor = oText.createTextCursor()
<BR>
&nbsp; &nbsp;ElseIf oOutput.SupportsService( "com.sun.star.drawing.Text" ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oText = oOutput
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oCursor = oText.createTextCursor()
<BR>
&nbsp; &nbsp;ElseIf oOutput.SupportsService( "com.sun.star.text.Text" ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oText = oOutput
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oCursor = oText.createTextCursor()
<BR>
&nbsp; &nbsp;ElseIf oOutput.SupportsService( "com.sun.star.text.TextCursor" ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oCursor = oOutput
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oText = oCursor.getText()
<BR>
&nbsp; &nbsp;Else
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Exit Sub
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oCursor.gotoEnd( False )
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;nLen = Len( cString )
<BR>
&nbsp; &nbsp;nStart = 1
<BR>
&nbsp; &nbsp;Do
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;nPos = Instr( nStart, cString, Chr(13) )
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;bCRFound = (nPos &gt; 0)
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;If Not bCRFound Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;nPos = nLen + 1
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;cSegment = Mid( cString, nStart, nPos-nStart )
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;nStart = nPos + 1
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oText.insertString( oCursor, cSegment, False )
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;If bCRFound Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;oText.insertControlCharacter( oCursor, com.sun.star.text.ControlCharacter.PARAGRAPH_BREAK, False )
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;Loop While bCRFound
<BR>
End Sub
<BR>

<BR>
' Same as Writer_Print(), just adds a line ending.
<BR>
Sub Writer_PrintLn( oOutput, Optional cString )
<BR>
&nbsp; &nbsp;If IsMissing( cString ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;cString = ""
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;Writer_Print( oOutput, cString + Chr(13) )
<BR>
End Sub
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>

<BR>
Here is the output produced by the above.....
<BR>

<BR>
image/x-MS-bmp
<BR>
application/postscript
<BR>
image/gif
<BR>
image/jpeg
<BR>
image/x-portable-bitmap
<BR>
image/x-pict
<BR>
image/x-portable-graymap
<BR>
image/png
<BR>
image/x-portable-pixmap
<BR>
image/x-cmu-raster
<BR>
image/svg+xml
<BR>
image/tiff
<BR>
image/x-xpixmap
<BR>

<BR>

<BR>
Here is a variation on the previous example that exports all shapes on the page, or only the selected shapes as a PNG file...
<BR>

<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">Sub ExportSelectedShapesToPNG()
<BR>
&nbsp; &nbsp;oDoc = ThisComponent
<BR>
&nbsp; &nbsp;oDocCtrl = oDoc.getCurrentController()
<BR>
&nbsp; &nbsp;oDrawPage = oDocCtrl.getCurrentPage()
<BR>
&nbsp; &nbsp;oSelection = oDocCtrl.getSelection()
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter = createUnoService( "com.sun.star.drawing.GraphicExportFilter" )
<BR>
&nbsp; &nbsp;If IsEmpty( oSelection ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oDrawPage )
<BR>
&nbsp; &nbsp;Else
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oSelection )
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;cExportUrl = oDoc.getURL()
<BR>
&nbsp; &nbsp;cExportUrl = Left( cExportUrl, Len(cExportUrl)-4 ) + "_" + oDrawPage.getName() + ".png"
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter.filter( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "MediaType", "image/png" ),_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "URL",&nbsp; &nbsp;&nbsp; &nbsp;cExportUrl ) ) )
<BR>
End Sub
<BR>

<BR>
Function MakePropertyValue( Optional cName As String, Optional uValue ) As com.sun.star.beans.PropertyValue
<BR>
&nbsp; &nbsp;oPropertyValue = createUnoStruct( "com.sun.star.beans.PropertyValue" )
<BR>
&nbsp; &nbsp;If Not IsMissing( cName ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oPropertyValue.Name = cName
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;If Not IsMissing( uValue ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oPropertyValue.Value = uValue
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;MakePropertyValue() = oPropertyValue
<BR>
End Function
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>

<BR>
This capability was originally requested in this thread.
<BR>
<A href="http://www.oooforum.org/forum/viewtopic.php?t=6053" target="_blank">http://www.oooforum.org/forum/viewtopic.php?t=6053</A><BR>_________________<BR><A href="http://ooomacros.org/user.php#91518" target="_blank" class="postlink">Want to make OOo Drawings like the colored flower design to the left?</A></SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row2" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap"><A href="http://www.oooforum.org/forum/profile.phtml?mode=viewprofile&u=479"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_profile.gif" alt="View user&#39;s profile" title="View user&#39;s profile" border="0"></A> <A href="http://www.oooforum.org/forum/privmsg.phtml?mode=post&u=479"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_pm.gif" alt="Send private message" title="Send private message" border="0"></A>     <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row1"><SPAN class="name"><A name="25104"></A><B>emil kasulzke</B></SPAN><BR><SPAN class="postdetails">Guest<BR><BR><BR><BR><BR></SPAN><BR></TD>
		<TD class="row1" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=25104#25104"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Sun Mar 14, 2004 12:27 am<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: </SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=25104"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">Good morning,
<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Quote:</B></SPAN></TD>	</TR>	<TR>	  <TD class="quote">
<BR>
emil, would you mind if this very interesting thread were moved to the Code Snippets forum? Please reply if that is okay (or not okay) with you.
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>
If you think Code Snippets is the right place, no problem, move it <IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_smile.gif" alt="Smile" border="0">
<BR>

<BR>
Btw, for finding out which parameters a given filter supports , I analyzed $OO_INSTALL_DIR/share/registry/res/en-US/org/openoffice/Office/Common.properties.
<BR>
I am sure that is not the intended way to do it, but does anyone know how to get these infos programatically? Neither the filter description page (http://framework.openoffice.org/files/documents/25/897/filter_description.html) explains this, nor does the oo dev guide. I am not interested in the mimetypes supported (or the filter names), but in the FilterData parameters (like TextMode, CompressionMode, PreviewFormat, etc).
<BR>

<BR>
Best regards,
<BR>

<BR>
emil
<BR>
 [/quote]</SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row1" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap">      <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row2"><SPAN class="name"><A name="25274"></A><B>DannyB</B></SPAN><BR><SPAN class="postdetails">Moderator<BR><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/rank5.gif" alt="Moderator" title="Moderator" border="0"><BR><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/41446a133fa81cc7182e6.gif" alt="" border="0"><BR><BR>Joined: 02 Apr 2003<BR>Posts: 3994<BR>Location: Lawrence, Kansas, USA</SPAN><BR></TD>
		<TD class="row2" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=25274#25274"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Mon Mar 15, 2004 2:34 pm<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: Re: code: draw: export current selection to eps</SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=25274"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">emil,
<BR>

<BR>
are you sure your FilterData options are actually having an effect?
<BR>

<BR>
I'm trying the following experiments, and I am not at all convinced that my filter options have any effect whatsoever....
<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">Sub Export1()
<BR>
&nbsp; &nbsp;cFile = "C:\Documents and Settings\dbrewer\Desktop\test.bmp"
<BR>
&nbsp; &nbsp;cUrl = ConvertToURL( cFile )
<BR>

<BR>
&nbsp; &nbsp;oDoc = ThisComponent
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oDoc.storeToURL( cUrl, _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "FilterName", "draw_bmp_Export" ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "FilterData",_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "ExportMode", 1 ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Resolution", 300 ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Color", 3 ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) )
<BR>
End Sub
<BR>

<BR>
&nbsp; &nbsp;
<BR>
Sub Export2()
<BR>
&nbsp; &nbsp;cFile = "C:\Documents and Settings\dbrewer\Desktop\test.bmp"
<BR>
&nbsp; &nbsp;cUrl = ConvertToURL( cFile )
<BR>

<BR>
&nbsp; &nbsp;oDoc = ThisComponent
<BR>
&nbsp; &nbsp;oDocCtrl = oDoc.getCurrentController()
<BR>
&nbsp; &nbsp;oDrawPage = oDocCtrl.getCurrentPage()
<BR>
&nbsp; &nbsp;oSelection = oDocCtrl.getSelection()
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter = createUnoService( "com.sun.star.drawing.GraphicExportFilter" )
<BR>
&nbsp; &nbsp;If IsEmpty( oSelection ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oDrawPage )
<BR>
&nbsp; &nbsp;Else
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oSelection )
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter.filter( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "MediaType", "image/x-MS-bmp" ),_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "URL",&nbsp; &nbsp;&nbsp; &nbsp;cUrl ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "FilterData",_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "ExportMode", 1 ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Resolution", 300 ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Color", 3 ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) )
<BR>
End Sub
<BR>

<BR>
&nbsp; &nbsp;
<BR>
Sub Export3()
<BR>
&nbsp; &nbsp;cFile = "C:\Documents and Settings\dbrewer\Desktop\test.png"
<BR>
&nbsp; &nbsp;cUrl = ConvertToURL( cFile )
<BR>

<BR>
&nbsp; &nbsp;oDoc = ThisComponent
<BR>
&nbsp; &nbsp;oDocCtrl = oDoc.getCurrentController()
<BR>
&nbsp; &nbsp;oDrawPage = oDocCtrl.getCurrentPage()
<BR>
&nbsp; &nbsp;oSelection = oDocCtrl.getSelection()
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter = createUnoService( "com.sun.star.drawing.GraphicExportFilter" )
<BR>
&nbsp; &nbsp;If IsEmpty( oSelection ) Then
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oDrawPage )
<BR>
&nbsp; &nbsp;Else
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;oExportFilter.setSourceDocument( oSelection )
<BR>
&nbsp; &nbsp;EndIf
<BR>
&nbsp; &nbsp;
<BR>
&nbsp; &nbsp;oExportFilter.filter( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "MediaType", "image/png" ),_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "URL",&nbsp; &nbsp;&nbsp; &nbsp;cUrl ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "FilterData",_
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Array( _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Compression", 9 ), _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;MakePropertyValue( "Interlaced", 0 ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) ) _
<BR>
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;) )
<BR>
End Sub
<BR>
</TD>	</TR></TBODY></TABLE><SPAN class="postbody"><BR>_________________<BR><A href="http://ooomacros.org/user.php#91518" target="_blank" class="postlink">Want to make OOo Drawings like the colored flower design to the left?</A></SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row2" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap"><A href="http://www.oooforum.org/forum/profile.phtml?mode=viewprofile&u=479"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_profile.gif" alt="View user&#39;s profile" title="View user&#39;s profile" border="0"></A> <A href="http://www.oooforum.org/forum/privmsg.phtml?mode=post&u=479"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_pm.gif" alt="Send private message" title="Send private message" border="0"></A>     <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row1"><SPAN class="name"><A name="25895"></A><B>Guest</B></SPAN><BR><SPAN class="postdetails"><BR><BR><BR><BR><BR></SPAN><BR></TD>
		<TD class="row1" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=25895#25895"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Sat Mar 20, 2004 8:20 am<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: </SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=25895"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">Hi Danny,
<BR>

<BR>
</SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Quote:</B></SPAN></TD>	</TR>	<TR>	  <TD class="quote">are you sure your FilterData options are actually having an effect? </TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>

<BR>
I use ColorMode and Level with different values, both Parameters have the desired effect. 
<BR>
Using CompressionMode does not work at all, the eps contains binary garbage in front of the otherwise valid PS instructions (the garbage can easily be removed with a text editor), no matter how I set compression mode. Therefore I removed the CompressionMode parameter from my script. This seems to be a known OOo bug (don't remember the bug id).
<BR>

<BR>
I had been toying around with storeToUrl + FilterData, but this did not work at all, I don't know why.
<BR>
 
<BR>
emil[/quote]</SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row1" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap">      <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR>
		<TD width="150" align="left" valign="top" class="row2"><SPAN class="name"><A name="226754"></A><B>Ikkyo</B></SPAN><BR><SPAN class="postdetails">Newbie<BR><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/rank1.gif" alt="Newbie" title="Newbie" border="0"><BR><BR><BR>Joined: 21 May 2007<BR>Posts: 1<BR></SPAN><BR></TD>
		<TD class="row2" width="100%" height="28" valign="top"><TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
			<TBODY><TR>
				<TD width="100%"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#226754"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_minipost.gif" width="12" height="9" alt="Post" title="Post" border="0"></A><SPAN class="postdetails">Posted: Mon May 21, 2007 12:18 am<SPAN class="gen">&nbsp;</SPAN>&nbsp; &nbsp;Post subject: </SPAN></TD>
				<TD valign="top" nowrap="nowrap"><A href="http://www.oooforum.org/forum/posting.phtml?mode=quote&p=226754"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_quote.gif" alt="Reply with quote" title="Reply with quote" border="0"></A>   </TD>
			</TR>
			<TR>
				<TD colspan="2"><HR></TD>
			</TR>
			<TR>
				<TD colspan="2"><SPAN class="postbody">The script of the original poster still works in OpenOffice 2.0, after the following modification(s):
<BR>

<BR>
use </SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">aArgs(0).Value = "image/x-eps"</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>
instead of </SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">aArgs(0).Value = "application/postscript"</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>

<BR>
I also had to use </SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">aFilterData(2).Value = 0</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>
instead of </SPAN><TABLE width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><TBODY><TR> 	  <TD><SPAN class="genmed"><B>Code:</B></SPAN></TD>	</TR>	<TR>	  <TD class="code">aFilterData(2).Value = 1</TD>	</TR></TBODY></TABLE><SPAN class="postbody">
<BR>
to get the formulae and special fonts exported correctly.</SPAN><SPAN class="gensmall"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="row2" width="150" align="left" valign="middle"><SPAN class="nav"><A href="http://www.oooforum.org/forum/viewtopic.phtml?p=226754#top" class="nav">Back to top</A></SPAN></TD>
		<TD class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"><TABLE cellspacing="0" cellpadding="0" border="0" height="18" width="18">
			<TBODY><TR>
				<TD valign="middle" nowrap="nowrap"><A href="http://www.oooforum.org/forum/profile.phtml?mode=viewprofile&u=48475"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_profile.gif" alt="View user&#39;s profile" title="View user&#39;s profile" border="0"></A> <A href="http://www.oooforum.org/forum/privmsg.phtml?mode=post&u=48475"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/icon_pm.gif" alt="Send private message" title="Send private message" border="0"></A>     <SCRIPT language="JavaScript" type="text/javascript"><!--

	if ( navigator.userAgent.toLowerCase().indexOf('mozilla') != -1 && navigator.userAgent.indexOf('5.') == -1 && navigator.userAgent.indexOf('6.') == -1 )
		document.write(' ');
	else
		document.write('</td><td>&nbsp;</td><td valign="top" nowrap="nowrap"><div style="position:relative"><div style="position:absolute"></div><div style="position:absolute;left:3px;top:-1px"></div></div>');

				//--></SCRIPT></TD><TD>&nbsp;</TD><TD valign="top" nowrap="nowrap"><DIV style="position:relative"><DIV style="position:absolute"></DIV><DIV style="position:absolute;left:3px;top:-1px"></DIV></DIV><NOSCRIPT></NOSCRIPT></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
	<TR>
		<TD class="spaceRow" colspan="2" height="1"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/spacer.gif" alt="" width="1" height="1"></TD>
	</TR>
	<TR align="center">
		<TD class="catBottom" colspan="2" height="28"><TABLE cellspacing="0" cellpadding="0" border="0">
			<TBODY><TR><FORM method="post" action="http://www.oooforum.org/forum/viewtopic.phtml?t=6769&start=0"></FORM>
				<TD align="center"><SPAN class="gensmall">Display posts from previous: <SELECT name="postdays"><OPTION value="0" selected="selected">All Posts</OPTION><OPTION value="1">1 Day</OPTION><OPTION value="7">7 Days</OPTION><OPTION value="14">2 Weeks</OPTION><OPTION value="30">1 Month</OPTION><OPTION value="90">3 Months</OPTION><OPTION value="180">6 Months</OPTION><OPTION value="364">1 Year</OPTION></SELECT>&nbsp;<SELECT name="postorder"><OPTION value="asc" selected="selected">Oldest First</OPTION><OPTION value="desc">Newest First</OPTION></SELECT>&nbsp;<INPUT type="submit" value="Go" class="liteoption" name="submit"></SPAN></TD>
			</TR>
		</TBODY></TABLE></TD>
	</TR>
</TBODY></TABLE>

<TABLE width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
  <TBODY><TR>
	<TD align="left" valign="middle" nowrap="nowrap"><SPAN class="nav"><A href="http://www.oooforum.org/forum/posting.phtml?mode=newtopic&f=11"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/post.gif" border="0" alt="Post new topic" align="middle"></A>&nbsp;&nbsp;&nbsp;<A href="http://www.oooforum.org/forum/posting.phtml?mode=reply&t=6769"><IMG src="./OpenOffice.org Forum    code  draw  export current selection to eps_files/reply.gif" border="0" alt="Reply to topic" align="middle"></A></SPAN></TD>
	<TD align="left" valign="middle" width="100%"><SPAN class="nav">&nbsp;&nbsp;&nbsp;<A href="http://www.oooforum.org/forum/index.phtml" class="nav">OOoForum.org Forum Index</A>
	  -&gt; <A href="http://www.oooforum.org/forum/viewforum.phtml?f=11" class="nav">OpenOffice.org Code Snippets</A></SPAN></TD>
	<TD align="right" valign="top" nowrap="nowrap"><SPAN class="gensmall">All times are GMT - 8 Hours</SPAN><BR><SPAN class="nav"></SPAN>
	  </TD>
  </TR>
  <TR>
	<TD align="left" colspan="3"><SPAN class="nav">Page <B>1</B> of <B>1</B></SPAN></TD>
  </TR>
</TBODY></TABLE>

<TABLE width="100%" cellspacing="2" border="0" align="center">
  <TBODY><TR>
	<TD width="40%" valign="top" nowrap="nowrap" align="left"><SPAN class="gensmall"></SPAN><BR>
	  &nbsp;<BR>
	  </TD>
	<TD align="right" valign="top" nowrap="nowrap">
<FORM method="get" name="jumpbox" action="http://www.oooforum.org/forum/viewforum.phtml" onsubmit="if(document.jumpbox.f.value == -1){return false;}"><TABLE cellspacing="0" cellpadding="0" border="0">
	<TBODY><TR>
		<TD nowrap="nowrap"><SPAN class="gensmall">Jump to:&nbsp;<SELECT name="f" onchange="if(this.options[this.selectedIndex].value != -1){ forms[&#39;jumpbox&#39;].submit() }"><OPTION value="-1">Select a forum</OPTION><OPTION value="-1">&nbsp;</OPTION><OPTION value="-1">OpenOffice.org Forums</OPTION><OPTION value="-1">----------------</OPTION><OPTION value="1">Setup and Troubleshooting</OPTION><OPTION value="2">OpenOffice.org Writer</OPTION><OPTION value="3">OpenOffice.org Calc</OPTION><OPTION value="4">OpenOffice.org Impress</OPTION><OPTION value="5">OpenOffice.org Draw</OPTION><OPTION value="6">OpenOffice.org Math</OPTION><OPTION value="10">OpenOffice.org Base</OPTION><OPTION value="9">OpenOffice.org Macros and API</OPTION><OPTION value="11" selected="selected">OpenOffice.org Code Snippets</OPTION><OPTION value="-1">&nbsp;</OPTION><OPTION value="-1">Community Forums</OPTION><OPTION value="-1">----------------</OPTION><OPTION value="7">General Discussion</OPTION><OPTION value="8">Site Feedback</OPTION></SELECT><INPUT type="hidden" name="sid" value="c15b42ae609caaa79c28dbe41e82ab5c">&nbsp;<INPUT type="submit" value="Go" class="liteoption"></SPAN></TD>
	</TR>
</TBODY></TABLE></FORM>

<SPAN class="gensmall">You <B>cannot</B> post new topics in this forum<BR>You <B>cannot</B> reply to topics in this forum<BR>You <B>cannot</B> edit your posts in this forum<BR>You <B>cannot</B> delete your posts in this forum<BR>You <B>cannot</B> vote in polls in this forum<BR></SPAN></TD>
  </TR>
</TBODY></TABLE>


<DIV align="center"><SPAN class="copyright"><BR><BR>
<!--
	We request you retain the full copyright notice below including the link to www.phpbb.com.
	This not only gives respect to the large amount of time given freely by the developers
	but also helps build interest, traffic and use of phpBB 2.0. If you cannot (for good
	reason) retain the full copyright we request you at least leave in place the
	Powered by phpBB line, with phpBB linked to www.phpbb.com. If you refuse
	to include even this then support on our forums may be affected.

	The phpBB Group : 2002
// -->
Powered by <A href="http://www.phpbb.com/" target="_phpbb" class="copyright">phpBB</A> © 2001, 2005 phpBB Group<BR></SPAN></DIV>
		</TD>
	</TR>
</TBODY></TABLE>




</BODY></HTML>